[Keyword "module",Spacing " ",VarOrFunOrConst "CommentRemoval",Spacing " ",Keyword "("]
[Spacing "    ",VarOrFunOrConst "HighLevelToken",Keyword ","]
[Spacing "    ",VarOrFunOrConst "hltToString",Keyword ","]
[Spacing "    ",VarOrFunOrConst "isOnlyIndentationLine",Keyword ","]
[Spacing "    ",VarOrFunOrConst "rmCmtsWrapper",Keyword ","]
[Spacing "    ",VarOrFunOrConst "lowLevelTokenizeWrapper",Keyword ","]
[Spacing "    ",VarOrFunOrConst "highLevelTokenizeWrapper",Keyword ","]
[Keyword ")",Spacing " ",Keyword "where"]
[]
[Keyword "import",Spacing " ",VarOrFunOrConst "Control",Keyword ".",VarOrFunOrConst "Exception"]
[Keyword "import",Spacing " ",VarOrFunOrConst "Data",Keyword ".",VarOrFunOrConst "Char",Spacing " ",Keyword "(",VarOrFunOrConst "isSpace",Keyword ")"]
[Keyword "import",Spacing " ",VarOrFunOrConst "Data",Keyword ".",VarOrFunOrConst "Maybe"]
[Keyword "import",Spacing " ",VarOrFunOrConst "Data",Keyword ".",VarOrFunOrConst "List"]
[Keyword "import",Spacing " ",VarOrFunOrConst "System",Keyword ".",VarOrFunOrConst "IO"]
[]
[Keyword "type",Spacing " ",VarOrFunOrConst "Token",Spacing "       ",Keyword "=",Spacing " ",VarOrFunOrConst "String"]
[Keyword "type",Spacing " ",VarOrFunOrConst "CodeStr",Spacing "     ",Keyword "=",Spacing " ",VarOrFunOrConst "String"]
[Keyword "type",Spacing " ",VarOrFunOrConst "ShortCmtStr",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "String"]
[Keyword "type",Spacing " ",VarOrFunOrConst "LongCmtStr",Spacing "  ",Keyword "=",Spacing " ",VarOrFunOrConst "String"]
[]
[ShortComment "-- A source file can be seen as a list of text lines. Each one"]
[ShortComment "-- being made of different items :"]
[ShortComment "-- source code, comments, comment delimiters, string constant, etc."]
[Keyword "data",Spacing " ",VarOrFunOrConst "LowLevelToken",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "|",Spacing " ",VarOrFunOrConst "CmtBegin",Spacing "          ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "|",Spacing " ",VarOrFunOrConst "CmtEnd",Spacing "            ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "|",Spacing " ",VarOrFunOrConst "LineCmtMark",Spacing "       ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "|",Spacing " ",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "|",Spacing " ",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "Token"]
[Spacing "                   ",Keyword "deriving",Spacing " ",VarOrFunOrConst "Show"]
[]
[Keyword "data",Spacing " ",VarOrFunOrConst "HighLevelToken",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "Code",Spacing "     ",VarOrFunOrConst "CodeStr"]
[Spacing "                    ",Keyword "|",Spacing " ",VarOrFunOrConst "ShortCmt",Spacing " ",VarOrFunOrConst "ShortCmtStr"]
[Spacing "                    ",Keyword "|",Spacing " ",VarOrFunOrConst "LongCmt",Spacing "  ",VarOrFunOrConst "LongCmtStr"]
[Spacing "                    ",Keyword "|",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "CodeStr"]
[Spacing "                    ",Keyword "|",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "ShortCmtStr"]
[Spacing "                    ",Keyword "|",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "LongCmtStr"]
[Spacing "                    ",Keyword "deriving",Spacing " ",VarOrFunOrConst "Show"]
[]
[Keyword "data",Spacing " ",VarOrFunOrConst "ParserState",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "ReadingCode"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingShortCmt"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingLongCmt"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingStringInCode"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInCode"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInShortCmt"]
[Spacing "                 ",Keyword "|",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInLongCmt"]
[Spacing "                 ",Keyword "deriving",Spacing " ",VarOrFunOrConst "Show"]
[]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "LowLevelToken",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "CmtBegin",Spacing "          ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "CmtEnd",Spacing "            ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing "       ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "lltToString",Spacing " ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "HighLevelToken",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "Code",Spacing "             ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "ShortCmt",Spacing "         ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "LongCmt",Spacing "          ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[VarOrFunOrConst "hltToString",Spacing " ",Keyword "(",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "s",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "s"]
[]
[VarOrFunOrConst "isOnlyIndentationLine",Spacing " ",Keyword "::",Spacing " ",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Bool"]
[VarOrFunOrConst "isOnlyIndentationLine",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[VarOrFunOrConst "isOnlyIndentationLine",Spacing " ",Keyword "(",VarOrFunOrConst "x",Keyword ":",Keyword "[",Keyword "]",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "isOnlyIndentation",Spacing " ",VarOrFunOrConst "x"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",VarOrFunOrConst "isOnlyIndentation",Spacing " ",Keyword "(",VarOrFunOrConst "Code",Spacing " ",VarOrFunOrConst "\"\"",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[Spacing "      ",VarOrFunOrConst "isOnlyIndentation",Spacing " ",Keyword "(",VarOrFunOrConst "Code",Spacing " ",VarOrFunOrConst "str",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "all",Spacing " ",VarOrFunOrConst "isSpace",Spacing " ",VarOrFunOrConst "str"]
[Spacing "      ",VarOrFunOrConst "isOnlyIndentation",Spacing " ",Keyword "_",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[VarOrFunOrConst "isOnlyIndentationLine",Spacing " ",Keyword "_",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[]
[VarOrFunOrConst "promote",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "ParserState",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "LowLevelToken",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "HighLevelToken"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingCode",Spacing "             ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "Code",Spacing "             ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingShortCmt",Spacing "         ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "ShortCmt",Spacing "         ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingLongCmt",Spacing "          ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "LongCmt",Spacing "          ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInCode",Spacing "     ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt",Spacing " ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt",Spacing "  ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingCode",Spacing "             ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingShortCmt",Spacing "         ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingLongCmt",Spacing "          ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInCode",Spacing "     ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt",Spacing " ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt",Spacing "  ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing "  ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInCode",Spacing "     ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt",Spacing " ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt",Spacing "  ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing "  ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingCode",Spacing "             ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "="]
[Spacing "    ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"while ReadingCode, got EscapedChar: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingShortCmt",Spacing "         ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "="]
[Spacing "    ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"while ReadingShortCmt, got EscapedChar: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingLongCmt",Spacing "          ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "="]
[Spacing "    ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"while ReadingLongCmt, got EscapedChar: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInCode",Spacing "               ",VarOrFunOrConst "x",Spacing "  ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode"]
[Spacing "                                                          ",Keyword "(",VarOrFunOrConst "lltToString",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInShortCmt",Spacing "           ",VarOrFunOrConst "x",Spacing "  ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInShortCmt"]
[Spacing "                                                          ",Keyword "(",VarOrFunOrConst "lltToString",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInLongCmt",Spacing "            ",VarOrFunOrConst "x",Spacing "  ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInLongCmt"]
[Spacing "                                                          ",Keyword "(",VarOrFunOrConst "lltToString",Spacing " ",VarOrFunOrConst "x",Keyword ")"]
[VarOrFunOrConst "promote",Spacing " ",Keyword "_",Spacing "                       ",Keyword "(",VarOrFunOrConst "CmtBegin",Spacing "          ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "LongCmt",Spacing "          ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",Keyword "_",Spacing "                       ",Keyword "(",VarOrFunOrConst "CmtEnd",Spacing "            ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "LongCmt",Spacing "          ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "ReadingStringInCode",Spacing "     ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "StringInCode",Spacing "     ",VarOrFunOrConst "x"]
[VarOrFunOrConst "promote",Spacing " ",Keyword "_",Spacing "                       ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing "       ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "ShortCmt",Spacing "         ",VarOrFunOrConst "x"]
[]
[VarOrFunOrConst "startWithList",Spacing " ",Keyword "::",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Maybe",Spacing " ",VarOrFunOrConst "Token"]
[ShortComment "-- FBR: use a map/fold here instead of explicit recursion ?"]
[VarOrFunOrConst "startWithList",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "_",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "Nothing"]
[VarOrFunOrConst "startWithList",Spacing " ",Keyword "(",VarOrFunOrConst "prfx",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "str"]
[Spacing "    ",Keyword "|",Spacing " ",VarOrFunOrConst "isPrefixOf",Spacing " ",VarOrFunOrConst "prfx",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "prfx"]
[Spacing "    ",Keyword "|",Spacing " ",VarOrFunOrConst "otherwise",Spacing "           ",Keyword "=",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "others",Spacing " ",VarOrFunOrConst "str"]
[]
[ShortComment "-- the remaining string is modified by a token or by a letter consumption"]
[VarOrFunOrConst "firstMatchedTok",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]"]
[Spacing "                ",Keyword "->",Spacing " ",VarOrFunOrConst "Maybe",Spacing " ",Keyword "(",VarOrFunOrConst "LowLevelToken",Keyword ",",Spacing " ",VarOrFunOrConst "String",Keyword ")"]
[VarOrFunOrConst "firstMatchedTok",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "Nothing"]
[VarOrFunOrConst "firstMatchedTok",Spacing " ",VarOrFunOrConst "str",Keyword "@",Keyword "(",VarOrFunOrConst "c",Keyword ":",VarOrFunOrConst "cs",Keyword ")",Spacing " ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters"]
[Spacing "                ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "case",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "escChars",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "of"]
[Spacing "      ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "matched",Spacing " ",Keyword "->"]
[Spacing "          ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing " ",VarOrFunOrConst "matched"]
[Spacing "               ",Keyword ",",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "matched",Spacing " ",VarOrFunOrConst "str",Keyword ")"]
[Spacing "      ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->"]
[Spacing "          ",Keyword "case",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "of"]
[Spacing "            ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "matched",Spacing " ",Keyword "->"]
[Spacing "                ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",VarOrFunOrConst "matched"]
[Spacing "                     ",Keyword ",",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "matched",Spacing " ",VarOrFunOrConst "str",Keyword ")"]
[Spacing "            ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "matched",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "CmtBegin",Spacing " ",VarOrFunOrConst "matched"]
[Spacing "                           ",Keyword ",",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "matched",Spacing " ",VarOrFunOrConst "str",Keyword ")"]
[Spacing "                  ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->"]
[Spacing "                      ",Keyword "case",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "of"]
[Spacing "                        ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "matched",Spacing " ",Keyword "->"]
[Spacing "                            ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "CmtEnd",Spacing " ",VarOrFunOrConst "matched"]
[Spacing "                                 ",Keyword ",",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "matched",Spacing " ",VarOrFunOrConst "str",Keyword ")"]
[Spacing "                        ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->"]
[Spacing "                            ",Keyword "case",Spacing " ",VarOrFunOrConst "startWithList",Spacing " ",VarOrFunOrConst "shortCmtStarters",Spacing " ",VarOrFunOrConst "str",Spacing " ",Keyword "of"]
[Spacing "                              ",VarOrFunOrConst "Just",Spacing " ",VarOrFunOrConst "matched",Spacing " ",Keyword "->"]
[Spacing "                                  ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing " ",VarOrFunOrConst "matched"]
[Spacing "                                       ",Keyword ",",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "matched",Spacing " ",VarOrFunOrConst "str",Keyword ")"]
[Spacing "                              ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",Keyword "(",VarOrFunOrConst "c",Keyword ":",Keyword "[",Keyword "]",Keyword ")"]
[Spacing "                                              ",Keyword ",",VarOrFunOrConst "cs",Keyword ")"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",ShortComment "-- !!! tok _MUST_ be a prefix of str !!!"]
[Spacing "      ",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "Token",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String"]
[Spacing "      ",VarOrFunOrConst "consumeTokenUnsafe",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "tokPrefixedStr",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "drop",Spacing " ",Keyword "(",VarOrFunOrConst "length",Spacing " ",VarOrFunOrConst "tok",Keyword ")",Spacing " ",VarOrFunOrConst "tokPrefixedStr"]
[]
[ShortComment "-- line to list of tokens"]
[VarOrFunOrConst "tokenizeSrcLine",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "Bool"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]"]
[ShortComment "-- empty line in source file"]
[VarOrFunOrConst "tokenizeSrcLine",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",VarOrFunOrConst "\"\"",Spacing " ",Keyword "=",Spacing " ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "\"\"",Keyword ")",Keyword ":",Keyword "[",Keyword "]"]
[ShortComment "-- non empty line"]
[VarOrFunOrConst "tokenizeSrcLine",Spacing " ",VarOrFunOrConst "escaping"]
[Spacing "                ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters",Spacing " ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars"]
[Spacing "                ",VarOrFunOrConst "acc",Spacing " ",VarOrFunOrConst "srcLine",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "case",Spacing " ",VarOrFunOrConst "firstMatchedTok",Spacing " ",VarOrFunOrConst "srcLine",Spacing " ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters"]
[Spacing "                         ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars",Spacing " ",Keyword "of"]
[Spacing "      ",VarOrFunOrConst "Nothing",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "reverse",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "      ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "tok",Keyword ",",Spacing " ",Keyword "[",Keyword "]",Keyword ")",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "reverse",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "escaping",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "acc",Keyword ")"]
[Spacing "      ",VarOrFunOrConst "Just",Spacing " ",Keyword "(",VarOrFunOrConst "tok",Keyword ",",Spacing " ",VarOrFunOrConst "remaining",Keyword "@",Keyword "(",Keyword "_",Keyword ":",Keyword "_",Keyword ")",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "          ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "            ",VarOrFunOrConst "EscapedChar",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                ",VarOrFunOrConst "tokenizeSrcLine",Spacing " ",Keyword "(",VarOrFunOrConst "xor",Spacing " ",VarOrFunOrConst "True",Spacing " ",VarOrFunOrConst "escaping",Keyword ")"]
[Spacing "                                ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters"]
[Spacing "                                ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars"]
[Spacing "                                ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "escaping",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "acc",Keyword ")",Spacing " ",VarOrFunOrConst "remaining"]
[Spacing "            ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                ",VarOrFunOrConst "tokenizeSrcLine",Spacing " ",VarOrFunOrConst "False"]
[Spacing "                                ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters"]
[Spacing "                                ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars"]
[Spacing "                                ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "escaping",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "acc",Keyword ")",Spacing " ",VarOrFunOrConst "remaining"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "Bool",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "LowLevelToken",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",Keyword "_",Spacing " ",VarOrFunOrConst "elt",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "elt",Keyword ":",Keyword "[",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "escaping'",Spacing " ",VarOrFunOrConst "elt",Spacing " ",VarOrFunOrConst "lst",Keyword "@",Keyword "(",VarOrFunOrConst "x",Keyword ":",VarOrFunOrConst "xs",Keyword ")"]
[Spacing "          ",Keyword "|",Spacing " ",VarOrFunOrConst "escaping'",Spacing " ",Keyword "="]
[Spacing "              ",Keyword "case",Spacing " ",VarOrFunOrConst "x",Spacing " ",Keyword "of"]
[Spacing "                ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "                    ",Keyword "(",VarOrFunOrConst "EscapedChar",Spacing " ",Keyword "(",VarOrFunOrConst "z",Spacing " ",Keyword "++",Spacing " ",Keyword "(",VarOrFunOrConst "lltToString",Spacing " ",VarOrFunOrConst "elt",Keyword ")",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "                ",Keyword "_",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"x is not an EscapedChar while we are escaping: \""]
[Spacing "                            ",Keyword "++",Spacing " ",Keyword "(",VarOrFunOrConst "lltToString",Spacing " ",VarOrFunOrConst "elt",Keyword ")",Keyword ")"]
[Spacing "          ",Keyword "|",Spacing " ",VarOrFunOrConst "otherwise",Spacing " ",Keyword "="]
[Spacing "              ",Keyword "case",Spacing " ",Keyword "(",VarOrFunOrConst "elt",Keyword ",",Spacing " ",VarOrFunOrConst "x",Keyword ")",Spacing " ",Keyword "of"]
[Spacing "                ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "                    ",Keyword "(",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",Keyword "(",VarOrFunOrConst "z",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "y",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "                ",Keyword "(",VarOrFunOrConst "CmtBegin",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "CmtBegin",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "                    ",Keyword "(",VarOrFunOrConst "CmtBegin",Spacing " ",Keyword "(",VarOrFunOrConst "z",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "y",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "                ",Keyword "(",VarOrFunOrConst "CmtEnd",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "CmtEnd",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "                    ",Keyword "(",VarOrFunOrConst "CmtEnd",Spacing " ",Keyword "(",VarOrFunOrConst "z",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "y",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "                ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "LineCmtMark",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "                    ",Keyword "(",VarOrFunOrConst "LineCmtMark",Spacing " ",Keyword "(",VarOrFunOrConst "z",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "y",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "                ",ShortComment "-- consecutive StringBeginOrEnd low level tokens must not be"]
[Spacing "                ",ShortComment "-- factorized together to manage correctly the empty string "]
[Spacing "                ",Keyword "_",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "elt",Keyword ":",VarOrFunOrConst "lst"]
[]
[VarOrFunOrConst "xor",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "Bool",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Bool",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Bool"]
[VarOrFunOrConst "xor",Spacing " ",VarOrFunOrConst "True",Spacing " ",VarOrFunOrConst "True",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[VarOrFunOrConst "xor",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "True"]
[]
[ShortComment "-- file name to list of lines read"]
[VarOrFunOrConst "getLines",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",VarOrFunOrConst "String",Keyword "]"]
[VarOrFunOrConst "getLines",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "do",Spacing " ",VarOrFunOrConst "mfh",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "try",Spacing " ",Keyword "(",VarOrFunOrConst "openFile",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",VarOrFunOrConst "ReadMode",Keyword ")"]
[Spacing "       ",Keyword "case",Spacing " ",VarOrFunOrConst "mfh",Spacing " ",Keyword "of"]
[Spacing "         ",VarOrFunOrConst "Left",Spacing " ",VarOrFunOrConst "err",Spacing " ",Keyword "->",Spacing " ",Keyword "do",Spacing " ",VarOrFunOrConst "print",Spacing " ",VarOrFunOrConst "err"]
[Spacing "                        ",VarOrFunOrConst "return",Spacing " ",Keyword "[",Keyword "]"]
[Spacing "         ",VarOrFunOrConst "Right",Spacing " ",VarOrFunOrConst "h",Spacing " ",Keyword "->"]
[Spacing "             ",Keyword "do",Spacing " ",VarOrFunOrConst "getLines'",Spacing " ",VarOrFunOrConst "h",Spacing " ",Keyword "[",Keyword "]"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",VarOrFunOrConst "getLines'",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "Handle",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "String",Keyword "]",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",VarOrFunOrConst "String",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "getLines'",Spacing " ",VarOrFunOrConst "h",Spacing " ",VarOrFunOrConst "acc",Spacing " ",Keyword "="]
[Spacing "          ",Keyword "do",Spacing " ",VarOrFunOrConst "mline",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "try",Spacing " ",Keyword "(",VarOrFunOrConst "hGetLine",Spacing " ",VarOrFunOrConst "h",Keyword ")"]
[Spacing "             ",Keyword "case",Spacing " ",VarOrFunOrConst "mline",Spacing " ",Keyword "of"]
[Spacing "               ",VarOrFunOrConst "Left",Spacing " ",Keyword "_",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "return",Spacing " ",Keyword "(",VarOrFunOrConst "reverse",Spacing " ",VarOrFunOrConst "acc",Keyword ")"]
[Spacing "               ",VarOrFunOrConst "Right",Spacing " ",VarOrFunOrConst "line",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "getLines'",Spacing " ",VarOrFunOrConst "h",Spacing " ",Keyword "(",VarOrFunOrConst "line",Keyword ":",VarOrFunOrConst "acc",Keyword ")"]
[]
[ShortComment "-- file name to list of low level tokens"]
[VarOrFunOrConst "tokenizeFile",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "Token",Keyword "]"]
[Spacing "             ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]",Keyword "]"]
[VarOrFunOrConst "tokenizeFile",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters",Spacing " ",VarOrFunOrConst "stringDelims"]
[Spacing "             ",VarOrFunOrConst "escChars",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "do",Spacing " ",VarOrFunOrConst "readLines",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "getLines",Spacing " ",VarOrFunOrConst "fileName"]
[Spacing "       ",VarOrFunOrConst "return",Spacing " ",Keyword "(",VarOrFunOrConst "map",Spacing " ",Keyword "(",VarOrFunOrConst "tokenizeSrcLine",Spacing " ",VarOrFunOrConst "False"]
[Spacing "                                    ",VarOrFunOrConst "cmtStarters",Spacing " ",VarOrFunOrConst "cmtStopers",Spacing " ",VarOrFunOrConst "shortCmtStarters"]
[Spacing "                                    ",VarOrFunOrConst "stringDelims",Spacing " ",VarOrFunOrConst "escChars",Spacing " ",Keyword "[",Keyword "]",Keyword ")"]
[Spacing "                   ",VarOrFunOrConst "readLines",Keyword ")"]
[]
[ShortComment "-- low to high level tokens"]
[VarOrFunOrConst "highLevelTokens",Spacing " ",Keyword "::",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]",Keyword "]",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "ParserState",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Int"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]"]
[VarOrFunOrConst "highLevelTokens",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",Keyword "_",Spacing " ",VarOrFunOrConst "acc",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "reverse",Spacing " ",VarOrFunOrConst "acc"]
[VarOrFunOrConst "highLevelTokens",Spacing " ",Keyword "(",VarOrFunOrConst "line",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "depth",Spacing " ",VarOrFunOrConst "lineAcc",Spacing " ",VarOrFunOrConst "acc",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "case",Spacing " ",VarOrFunOrConst "line",Spacing " ",Keyword "of"]
[Spacing "      ",ShortComment "-- finished current line"]
[Spacing "      ",Keyword "[",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "case",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",Keyword "of"]
[Spacing "              ",VarOrFunOrConst "ReadingShortCmt",Spacing " ",Keyword "->"]
[Spacing "                  ",ShortComment "-- state only valid until end of current line"]
[Spacing "                  ",VarOrFunOrConst "highLevelTokens",Spacing " ",VarOrFunOrConst "others",Spacing " ",VarOrFunOrConst "ReadingCode"]
[Spacing "                                  ",VarOrFunOrConst "depth",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "(",Keyword "(",VarOrFunOrConst "reverse",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Keyword ":",VarOrFunOrConst "acc",Keyword ")"]
[Spacing "              ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                  ",VarOrFunOrConst "highLevelTokens",Spacing " ",VarOrFunOrConst "others",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                                  ",VarOrFunOrConst "depth",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "(",Keyword "(",VarOrFunOrConst "reverse",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Keyword ":",VarOrFunOrConst "acc",Keyword ")"]
[Spacing "      ",ShortComment "-- continuing current line"]
[Spacing "      ",Keyword "(",VarOrFunOrConst "tok",Keyword ":",VarOrFunOrConst "toks",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "          ",Keyword "case",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",Keyword "of"]
[Spacing "            ",VarOrFunOrConst "ReadingCode",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "LineCmtMark",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "ReadingShortCmt",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "CmtBegin",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingLongCmt"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "depth",Keyword "+",VarOrFunOrConst "1",Keyword ")",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInCode"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "CmtEnd",Spacing " ",VarOrFunOrConst "mark",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"got EndCmtMArk while ReadingCode: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "mark",Keyword ")"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",VarOrFunOrConst "esc",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"got EscapedChar while ReadingCode: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "esc",Keyword ")"]
[Spacing "            ",VarOrFunOrConst "ReadingShortCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",VarOrFunOrConst "esc",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"got EscapedChar while ReadingShortCmt: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "esc",Keyword ")"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingLongCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "CmtEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",Keyword "let",Spacing " ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "depth",Spacing " ",Keyword "-",Spacing " ",VarOrFunOrConst "1",Spacing " ",Keyword "in"]
[Spacing "                      ",Keyword "if",Spacing " ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "==",Spacing " ",VarOrFunOrConst "0",Spacing " ",Keyword "then"]
[Spacing "                          ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                             ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingCode"]
[Spacing "                             ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                      ",Keyword "else"]
[Spacing "                          ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                            ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                            ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "CmtBegin",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",Keyword "let",Spacing " ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "depth",Spacing " ",Keyword "+",Spacing " ",VarOrFunOrConst "1",Spacing " ",Keyword "in"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "newDepth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "CmtOrCodeOrString",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "LineCmtMark",Spacing " ",VarOrFunOrConst "mark",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"got LineCmtMark while ReadingLongCmt: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "mark",Keyword ")"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",VarOrFunOrConst "esc",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "error",Spacing " ",Keyword "(",VarOrFunOrConst "\"got EscapedChar while ReadingLongCmt: \"",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "esc",Keyword ")"]
[Spacing "            ",VarOrFunOrConst "ReadingStringInLongCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingLongCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInLongCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingStringInShortCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingStringInCode",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingCode"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",VarOrFunOrConst "EscapedChar",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingEscCharInStringInCode"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "parserState"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingEscCharInStringInCode",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingCode"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInCode"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingEscCharInStringInShortCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInShortCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "            ",VarOrFunOrConst "ReadingEscCharInStringInLongCmt",Spacing " ",Keyword "->"]
[Spacing "                ",Keyword "case",Spacing " ",VarOrFunOrConst "tok",Spacing " ",Keyword "of"]
[Spacing "                  ",VarOrFunOrConst "StringBeginOrEnd",Spacing " ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingLongCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "                  ",Keyword "_",Spacing " ",Keyword "->"]
[Spacing "                      ",VarOrFunOrConst "highLevelTokens"]
[Spacing "                         ",Keyword "(",VarOrFunOrConst "toks",Keyword ":",VarOrFunOrConst "others",Keyword ")",Spacing " ",VarOrFunOrConst "ReadingStringInLongCmt"]
[Spacing "                         ",VarOrFunOrConst "depth",Spacing " ",Keyword "(",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "parserState",Spacing " ",VarOrFunOrConst "tok",Spacing " ",VarOrFunOrConst "lineAcc",Keyword ")",Spacing " ",VarOrFunOrConst "acc"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "ParserState",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "LowLevelToken",Spacing " ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]"]
[Spacing "                ",Keyword "->",Spacing " ",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "state",Spacing " ",VarOrFunOrConst "elt",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "=",Spacing " ",Keyword "(",VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "state",Spacing " ",VarOrFunOrConst "elt",Keyword ")",Keyword ":",Keyword "[",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "factorize",Spacing " ",VarOrFunOrConst "state",Spacing " ",VarOrFunOrConst "elt",Spacing " ",VarOrFunOrConst "lst",Keyword "@",Keyword "(",VarOrFunOrConst "x",Keyword ":",VarOrFunOrConst "xs",Keyword ")",Spacing " ",Keyword "="]
[Spacing "        ",Keyword "let",Spacing " ",VarOrFunOrConst "elt'",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "promote",Spacing " ",VarOrFunOrConst "state",Spacing " ",VarOrFunOrConst "elt",Spacing " ",Keyword "in"]
[Spacing "        ",Keyword "case",Spacing " ",Keyword "(",VarOrFunOrConst "x",Keyword ",",Spacing " ",VarOrFunOrConst "elt'",Keyword ")",Spacing " ",Keyword "of"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "Code",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "Code",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->",Spacing " ",Keyword "(",VarOrFunOrConst "Code",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "ShortCmt",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "ShortCmt",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->",Spacing " ",Keyword "(",VarOrFunOrConst "ShortCmt",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "LongCmt",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "LongCmt",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->",Spacing " ",Keyword "(",VarOrFunOrConst "LongCmt",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "StringInCode",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "StringInCode",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->",Spacing " ",Keyword "(",VarOrFunOrConst "StringInCode",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "StringInShortCmt",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "              ",Keyword "(",VarOrFunOrConst "StringInShortCmt",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "(",VarOrFunOrConst "StringInLongCmt",Spacing " ",VarOrFunOrConst "y",Keyword ",",Spacing " ",VarOrFunOrConst "StringInLongCmt",Spacing " ",VarOrFunOrConst "z",Keyword ")",Spacing " ",Keyword "->"]
[Spacing "              ",Keyword "(",VarOrFunOrConst "StringInLongCmt",Spacing " ",Keyword "(",VarOrFunOrConst "y",Spacing " ",Keyword "++",Spacing " ",VarOrFunOrConst "z",Keyword ")",Keyword ")",Keyword ":",VarOrFunOrConst "xs"]
[Spacing "          ",Keyword "_",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "elt'",Keyword ":",VarOrFunOrConst "lst"]
[]
[VarOrFunOrConst "rmCmtsWrapper",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]"]
[VarOrFunOrConst "rmCmtsWrapper",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "do",Spacing " ",VarOrFunOrConst "lowLevelToks",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "tokenizeFile",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"--\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\"\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\\\"",Keyword "]"]
[Spacing "       ",Keyword "let",Spacing " ",VarOrFunOrConst "highLevelToks",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "highLevelTokens",Spacing " ",VarOrFunOrConst "lowLevelToks",Spacing " ",VarOrFunOrConst "ReadingCode",Spacing " ",VarOrFunOrConst "0",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",Keyword "]"]
[Spacing "           ",VarOrFunOrConst "codeOnly",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "removeComments",Spacing " ",VarOrFunOrConst "highLevelToks"]
[Spacing "       ",VarOrFunOrConst "return",Spacing " ",VarOrFunOrConst "codeOnly"]
[Spacing "    ",Keyword "where"]
[Spacing "      ",VarOrFunOrConst "removeComments",Spacing " ",Keyword "::",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]",Spacing " ",Keyword "->",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]"]
[Spacing "      ",VarOrFunOrConst "removeComments",Spacing " ",VarOrFunOrConst "srcLine",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "map",Spacing " ",Keyword "(",VarOrFunOrConst "filter",Spacing " ",VarOrFunOrConst "isCode",Keyword ")",Spacing " ",VarOrFunOrConst "srcLine"]
[]
[Spacing "      ",VarOrFunOrConst "isCode",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "HighLevelToken",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "Bool"]
[Spacing "      ",VarOrFunOrConst "isCode",Spacing " ",Keyword "(",VarOrFunOrConst "Code",Spacing " ",Keyword "_",Keyword ")",Spacing "         ",Keyword "=",Spacing " ",VarOrFunOrConst "True"]
[Spacing "      ",VarOrFunOrConst "isCode",Spacing " ",Keyword "(",VarOrFunOrConst "StringInCode",Spacing " ",Keyword "_",Keyword ")",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "True"]
[Spacing "      ",VarOrFunOrConst "isCode",Spacing " ",Keyword "_",Spacing "                ",Keyword "=",Spacing " ",VarOrFunOrConst "False"]
[]
[VarOrFunOrConst "lowLevelTokenizeWrapper",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "LowLevelToken",Keyword "]",Keyword "]"]
[VarOrFunOrConst "lowLevelTokenizeWrapper",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "do",Spacing " ",VarOrFunOrConst "lowLevelToks",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "tokenizeFile",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"--\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\"\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\\\"",Keyword "]"]
[Spacing "       ",VarOrFunOrConst "return",Spacing " ",VarOrFunOrConst "lowLevelToks"]
[]
[VarOrFunOrConst "highLevelTokenizeWrapper",Spacing " ",Keyword "::",Spacing " ",VarOrFunOrConst "String",Spacing " ",Keyword "->",Spacing " ",VarOrFunOrConst "IO",Spacing " ",Keyword "[",Keyword "[",VarOrFunOrConst "HighLevelToken",Keyword "]",Keyword "]"]
[VarOrFunOrConst "highLevelTokenizeWrapper",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "="]
[Spacing "    ",Keyword "do",Spacing " ",VarOrFunOrConst "lowLevelToks",Spacing " ",Keyword "<-",Spacing " ",VarOrFunOrConst "tokenizeFile",Spacing " ",VarOrFunOrConst "fileName",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"--\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\"\"",Keyword "]",Spacing " ",Keyword "[",VarOrFunOrConst "\"\\\\\"",Keyword "]"]
[Spacing "       ",Keyword "let",Spacing " ",VarOrFunOrConst "highLevelToks",Spacing " ",Keyword "=",Spacing " ",VarOrFunOrConst "highLevelTokens",Spacing " ",VarOrFunOrConst "lowLevelToks",Spacing " ",VarOrFunOrConst "ReadingCode",Spacing " ",VarOrFunOrConst "0",Spacing " ",Keyword "[",Keyword "]",Spacing " ",Keyword "[",Keyword "]"]
[Spacing "       ",VarOrFunOrConst "return",Spacing " ",VarOrFunOrConst "highLevelToks"]
